# Android é¢è¯•é¡¹ç›® - é¡¹ç›®æ€»ç»“æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªç”¨äºAndroidé¢è¯•ï¼ˆMachine Codingï¼‰çš„åŸºç¡€é¡¹ç›®æ¡†æ¶ã€‚é¡¹ç›®ä½¿ç”¨Kotlinè¯­è¨€å¼€å‘ï¼Œé‡‡ç”¨äº†ç°ä»£åŒ–çš„Androidå¼€å‘æ¶æ„å’Œæœ€ä½³å®è·µã€‚é¡¹ç›®å·²ç»é…ç½®å¥½äº†å¸¸ç”¨çš„ä¾èµ–åº“å’ŒåŸºç¡€æ¶æ„ï¼Œå¯ä»¥ä½œä¸ºé¢è¯•å¼€å‘çš„èµ·ç‚¹ã€‚

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Kotlin
- **æœ€ä½SDK**: 21 (Android 5.0)
- **ç›®æ ‡SDK**: 35
- **ç¼–è¯‘SDK**: 35
- **æ„å»ºå·¥å…·**: Gradle (Kotlin DSL)

### æ ¸å¿ƒä¾èµ–åº“

#### ä¾èµ–æ³¨å…¥
- **Koin 4.0.0**: è½»é‡çº§ä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œç”¨äºç®¡ç†åº”ç”¨ä¸­çš„ä¾èµ–å…³ç³»

#### ç½‘ç»œè¯·æ±‚
- **Retrofit 2.11.0**: ç±»å‹å®‰å…¨çš„HTTPå®¢æˆ·ç«¯ï¼Œç”¨äºREST APIè°ƒç”¨
- **OkHttp 4.12.0**: HTTPå®¢æˆ·ç«¯ï¼ŒRetrofitçš„åº•å±‚å®ç°
- **Gson 2.10.1**: JSONåºåˆ—åŒ–/ååºåˆ—åŒ–åº“

#### å“åº”å¼ç¼–ç¨‹
- **RxJava 2.2.21**: å“åº”å¼ç¼–ç¨‹åº“
- **RxAndroid 2.1.1**: RxJavaçš„Androidæ‰©å±•
- **RxKotlin 2.4.0**: RxJavaçš„Kotlinæ‰©å±•

#### æ•°æ®åº“
- **Room 2.6.1**: SQLiteæ•°æ®åº“æŠ½è±¡å±‚ï¼Œæä¾›ç±»å‹å®‰å…¨çš„æ•°æ®åº“è®¿é—®

#### UIç»„ä»¶
- **Material Design**: Google Material Designç»„ä»¶åº“
- **Navigation Component**: Androidå¯¼èˆªç»„ä»¶
- **RecyclerView**: åˆ—è¡¨å±•ç¤ºç»„ä»¶
- **Lottie 5.2.0**: åŠ¨ç”»åº“ï¼Œç”¨äºæ’­æ”¾JSONæ ¼å¼çš„åŠ¨ç”»

#### å›¾ç‰‡åŠ è½½
- **Picasso 2.71828**: å›¾ç‰‡åŠ è½½å’Œç¼“å­˜åº“

#### æ¶æ„ç»„ä»¶
- **Lifecycle**: ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶
- **ViewModel**: ç”¨äºå­˜å‚¨å’Œç®¡ç†UIç›¸å…³çš„æ•°æ®

## ğŸ“ é¡¹ç›®ç»“æ„

```
app/src/main/java/com/gopay/
â”œâ”€â”€ App.kt                          # Applicationç±»ï¼Œåˆå§‹åŒ–ä¾èµ–æ³¨å…¥
â”œâ”€â”€ MainActivity.kt                 # ä¸»Activity
â”œâ”€â”€ dependencies/                   # ä¾èµ–æ³¨å…¥æ¨¡å—
â”‚   â”œâ”€â”€ AppModule.kt               # åº”ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ NetworkModule.kt          # ç½‘ç»œæ¨¡å—ï¼ˆRetrofit + OkHttpï¼‰
â”‚   â”œâ”€â”€ StorageModule.kt           # å­˜å‚¨æ¨¡å—ï¼ˆRoom + SharedPreferencesï¼‰
â”‚   â”œâ”€â”€ DispatcherModule.kt        # åç¨‹è°ƒåº¦å™¨æ¨¡å—
â”‚   â””â”€â”€ ImageModule.kt             # å›¾ç‰‡åŠ è½½æ¨¡å—ï¼ˆPicassoï¼‰
â”œâ”€â”€ dispatcher/                    # åç¨‹è°ƒåº¦å™¨
â”‚   â”œâ”€â”€ CoroutineDispatcherProvider.kt      # è°ƒåº¦å™¨æ¥å£
â”‚   â””â”€â”€ RealCoroutineDispatcherProvider.kt  # è°ƒåº¦å™¨å®ç°
â”œâ”€â”€ persistance/                   # æ•°æ®æŒä¹…åŒ–
â”‚   â””â”€â”€ AppDatabase.kt             # Roomæ•°æ®åº“å®šä¹‰
â”œâ”€â”€ customviews/                   # è‡ªå®šä¹‰è§†å›¾
â”‚   â”œâ”€â”€ FullScreenView.kt          # å…¨å±è§†å›¾ï¼ˆåŠ è½½/é”™è¯¯çŠ¶æ€ï¼‰
â”‚   â””â”€â”€ FullScreenViewType.kt      # è§†å›¾ç±»å‹æšä¸¾
â””â”€â”€ extensions/                    # æ‰©å±•å‡½æ•°
    â”œâ”€â”€ ViewExtensions.kt          # Viewæ‰©å±•å‡½æ•°
    â”œâ”€â”€ PrimitiveExtensions.kt     # åŸºæœ¬ç±»å‹æ‰©å±•å‡½æ•°
    â””â”€â”€ ReactiveExtensions.kt      # LiveDataæ‰©å±•å‡½æ•°
```

## ğŸ”§ æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1. ä¾èµ–æ³¨å…¥æ¨¡å— (dependencies/)

é¡¹ç›®ä½¿ç”¨Koinè¿›è¡Œä¾èµ–æ³¨å…¥ï¼Œå°†æ‰€æœ‰ä¾èµ–é…ç½®åˆ†ä¸º5ä¸ªæ¨¡å—ï¼š

#### AppModule
- åº”ç”¨çº§åˆ«çš„ä¾èµ–æ¨¡å—
- å½“å‰ä¸ºç©ºï¼Œå¯æ ¹æ®éœ€è¦æ‰©å±•

#### NetworkModule
- **Gson**: JSONè½¬æ¢å™¨
- **OkHttp**: HTTPå®¢æˆ·ç«¯ï¼Œé…ç½®äº†ï¼š
  - ç¼“å­˜ï¼ˆ10MBï¼‰
  - è¶…æ—¶è®¾ç½®ï¼ˆè¿æ¥10sï¼Œå†™å…¥30sï¼Œè¯»å–10sï¼‰
  - æ—¥å¿—æ‹¦æˆªå™¨ï¼ˆä»…DEBUGæ¨¡å¼ï¼‰
- **Retrofit**: REST APIå®¢æˆ·ç«¯ï¼Œé…ç½®äº†ï¼š
  - åŸºç¡€URLï¼ˆä»BuildConfigè¯»å–ï¼‰
  - Gsonè½¬æ¢å™¨
  - RxJava2é€‚é…å™¨

#### StorageModule
- **SharedPreferences**: è½»é‡çº§é”®å€¼å¯¹å­˜å‚¨
- **Roomæ•°æ®åº“**: ç»“æ„åŒ–æ•°æ®å­˜å‚¨ï¼ˆå½“å‰åŒ…å«ExampleUserå®ä½“ç¤ºä¾‹ï¼‰

#### DispatcherModule
- åç¨‹è°ƒåº¦å™¨æä¾›è€…
- æä¾›Mainã€IOã€Defaultã€Unconfinedå››ç§è°ƒåº¦å™¨

#### ImageModule
- **Picasso**: å›¾ç‰‡åŠ è½½åº“
- é…ç½®ä½¿ç”¨OkHttp3Downloaderï¼Œå¤ç”¨ç½‘ç»œç¼“å­˜

### 2. åç¨‹è°ƒåº¦å™¨ (dispatcher/)

ä½¿ç”¨æ¥å£æŠ½è±¡åç¨‹è°ƒåº¦å™¨ï¼Œä¾¿äºæµ‹è¯•å’Œåˆ‡æ¢å®ç°ï¼š
- `CoroutineDispatcherProvider`: æ¥å£å®šä¹‰
- `RealCoroutineDispatcherProvider`: çœŸå®å®ç°ï¼Œä½¿ç”¨Kotlinæ ‡å‡†Dispatchers

### 3. æ•°æ®æŒä¹…åŒ– (persistance/)

#### Roomæ•°æ®åº“
- å®šä¹‰äº†`AppDatabase`æŠ½è±¡ç±»
- åŒ…å«ç¤ºä¾‹å®ä½“`ExampleUser`
- ç‰ˆæœ¬å·ï¼š1

**ä½¿ç”¨å»ºè®®**ï¼š
- å®šä¹‰DAOæ¥å£æ¥è®¿é—®æ•°æ®åº“
- åœ¨StorageModuleä¸­å·²é…ç½®æ•°æ®åº“å®ä¾‹
- å¯é€šè¿‡ä¾èµ–æ³¨å…¥è·å–æ•°æ®åº“å®ä¾‹

### 4. è‡ªå®šä¹‰è§†å›¾ (customviews/)

#### FullScreenView
å…¨å±çŠ¶æ€è§†å›¾ï¼Œç”¨äºæ˜¾ç¤ºï¼š
- **åŠ è½½çŠ¶æ€**: æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- **é”™è¯¯çŠ¶æ€**: æ˜¾ç¤ºé”™è¯¯åŠ¨ç”»å’Œé”™è¯¯ä¿¡æ¯

ä½¿ç”¨LottieåŠ¨ç”»åº“å®ç°åŠ¨ç”»æ•ˆæœã€‚

### 5. æ‰©å±•å‡½æ•° (extensions/)

#### ViewExtensions
ç®€åŒ–Viewæ“ä½œçš„æ‰©å±•å‡½æ•°ï¼š
- `visible()`: æ˜¾ç¤ºè§†å›¾
- `gone()`: éšè—è§†å›¾
- `isVisible()`: æ£€æŸ¥æ˜¯å¦å¯è§
- `isGone()`: æ£€æŸ¥æ˜¯å¦éšè—
- `inflate()`: åœ¨ViewGroupä¸­åŠ è½½å¸ƒå±€

#### PrimitiveExtensions
åŸºæœ¬ç±»å‹çš„æ‰©å±•å‡½æ•°ï¼š
- `String?.isValid()`: æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆ
- `Int.divide()`: æ•´æ•°é™¤æ³•ï¼Œè¿”å›æ ¼å¼åŒ–å­—ç¬¦ä¸²

#### ReactiveExtensions
LiveDataçš„æ‰©å±•å‡½æ•°ï¼š
- `MutableLiveData<Boolean>.show()`: è®¾ç½®ä¸ºtrue
- `MutableLiveData<Boolean>.hide()`: è®¾ç½®ä¸ºfalse

## ğŸš€ ä½¿ç”¨æŒ‡å—

### 1. åˆ›å»ºAPIæ¥å£

```kotlin
interface ApiService {
    @GET("users")
    fun getUsers(): Observable<List<User>>
}
```

### 2. åœ¨NetworkModuleä¸­æ³¨å†ŒAPIæœåŠ¡

```kotlin
factory<ApiService> {
    get<Retrofit>().create(ApiService::class.java)
}
```

### 3. ä½¿ç”¨ä¾èµ–æ³¨å…¥

```kotlin
class MainActivity : AppCompatActivity() {
    private val apiService: ApiService by inject()
    private val dispatcherProvider: CoroutineDispatcherProvider by inject()
    
    // ä½¿ç”¨æ³¨å…¥çš„ä¾èµ–
}
```

### 4. ä½¿ç”¨Roomæ•°æ®åº“

```kotlin
// 1. å®šä¹‰DAOæ¥å£
@Dao
interface UserDao {
    @Query("SELECT * FROM ExampleUser")
    fun getAllUsers(): Flowable<List<ExampleUser>>
}

// 2. åœ¨AppDatabaseä¸­æ·»åŠ DAO
@Database(entities = [ExampleUser::class], version = 1)
abstract class AppDatabase : RoomDatabase() {
    abstract fun userDao(): UserDao
}

// 3. é€šè¿‡ä¾èµ–æ³¨å…¥ä½¿ç”¨
private val database: AppDatabase by inject()
val users = database.userDao().getAllUsers()
```

### 5. ä½¿ç”¨æ‰©å±•å‡½æ•°

```kotlin
// Viewæ“ä½œ
textView.visible()
textView.gone()
if (textView.isVisible()) { ... }

// å­—ç¬¦ä¸²éªŒè¯
if (userName.isValid()) { ... }

// LiveDataæ“ä½œ
loadingLiveData.show()
errorLiveData.hide()
```

## ğŸ“ å¼€å‘å»ºè®®

### 1. æ¶æ„æ¨¡å¼
å»ºè®®é‡‡ç”¨ä»¥ä¸‹æ¶æ„æ¨¡å¼ä¹‹ä¸€ï¼š
- **MVVM (Model-View-ViewModel)**: ä½¿ç”¨ViewModelå’ŒLiveData
- **MVP (Model-View-Presenter)**: ä¼ ç»ŸMVPæ¨¡å¼
- **MVI (Model-View-Intent)**: å•å‘æ•°æ®æµ

### 2. ç½‘ç»œè¯·æ±‚
- ä½¿ç”¨Retrofitæ¥å£å®šä¹‰API
- ä½¿ç”¨RxJavaçš„Observableå¤„ç†å¼‚æ­¥æ“ä½œ
- åœ¨Repositoryå±‚å¤„ç†ç½‘ç»œè¯·æ±‚å’Œç¼“å­˜

### 3. æ•°æ®ç®¡ç†
- ä½¿ç”¨Repositoryæ¨¡å¼ç®¡ç†æ•°æ®æº
- Roomç”¨äºæœ¬åœ°æ•°æ®åº“
- SharedPreferencesç”¨äºç®€å•é…ç½®
- ç½‘ç»œæ•°æ®é€šè¿‡Retrofitè·å–

### 4. é”™è¯¯å¤„ç†
- ä½¿ç”¨FullScreenViewæ˜¾ç¤ºé”™è¯¯çŠ¶æ€
- å®ç°ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
- è®°å½•é”™è¯¯æ—¥å¿—

### 5. æµ‹è¯•
- ä½¿ç”¨Mockitoè¿›è¡Œå•å…ƒæµ‹è¯•
- ä½¿ç”¨Espressoè¿›è¡ŒUIæµ‹è¯•
- ä¸ºDispatcherProvideråˆ›å»ºæµ‹è¯•å®ç°

## ğŸ” å…³é”®æ¦‚å¿µè¯´æ˜

### ä¾èµ–æ³¨å…¥ (Dependency Injection)
ä½¿ç”¨Koinæ¡†æ¶å®ç°ä¾èµ–æ³¨å…¥ï¼Œä¼˜ç‚¹ï¼š
- é™ä½è€¦åˆåº¦
- ä¾¿äºæµ‹è¯•ï¼ˆå¯ä»¥æ³¨å…¥Mockå¯¹è±¡ï¼‰
- ä»£ç æ›´æ¸…æ™°

### åç¨‹è°ƒåº¦å™¨
Kotlinåç¨‹éœ€è¦æŒ‡å®šåœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œï¼š
- **Main**: UIçº¿ç¨‹ï¼Œç”¨äºæ›´æ–°ç•Œé¢
- **IO**: IOçº¿ç¨‹æ± ï¼Œç”¨äºç½‘ç»œã€æ–‡ä»¶æ“ä½œ
- **Default**: CPUçº¿ç¨‹æ± ï¼Œç”¨äºè®¡ç®—å¯†é›†å‹ä»»åŠ¡

### Roomæ•°æ®åº“
Roomæ˜¯SQLiteçš„æŠ½è±¡å±‚ï¼š
- ç¼–è¯‘æ—¶SQLéªŒè¯
- ç±»å‹å®‰å…¨
- ä¸LiveDataã€RxJavaé›†æˆ

### æ‰©å±•å‡½æ•°
Kotlinçš„æ‰©å±•å‡½æ•°å…è®¸ä¸ºç°æœ‰ç±»æ·»åŠ æ–°æ–¹æ³•ï¼š
- ä¸ä¿®æ”¹åŸå§‹ç±»
- ä½¿ä»£ç æ›´ç®€æ´
- æé«˜å¯è¯»æ€§

## ğŸ“¦ å¤–éƒ¨AARåº“

é¡¹ç›®åŒ…å«ä»¥ä¸‹AARåº“ï¼ˆåœ¨`libs/`ç›®å½•ï¼‰ï¼š
- `driver-info.aar`
- `payment.aar`
- `promo.aar`
- `trip-details.aar`

è¿™äº›åº“å·²é€šè¿‡`fileTree`è‡ªåŠ¨å¼•å…¥ï¼Œå¯åœ¨ä»£ç ä¸­ç›´æ¥ä½¿ç”¨ã€‚

## ğŸ› ï¸ æ„å»ºé…ç½®

### BuildConfig
- `API_BASE`: APIåŸºç¡€URLï¼ˆå½“å‰ä¸º"https://www.google.com"ï¼‰

### æ„å»ºç±»å‹
- **Debug**: å¯ç”¨æ—¥å¿—æ‹¦æˆªå™¨
- **Release**: ç¦ç”¨æ—¥å¿—ï¼Œå¯é…ç½®ä»£ç æ··æ·†

## ğŸ“š å­¦ä¹ èµ„æº

### Kotlin
- [Kotlinå®˜æ–¹æ–‡æ¡£](https://kotlinlang.org/docs/home.html)
- [Kotlinåç¨‹æŒ‡å—](https://kotlinlang.org/docs/coroutines-guide.html)

### Androidæ¶æ„
- [Android Architecture Components](https://developer.android.com/topic/architecture)
- [Androidå¼€å‘æŒ‡å—](https://developer.android.com/guide)

### ä¾èµ–åº“æ–‡æ¡£
- [Koinæ–‡æ¡£](https://insert-koin.io/)
- [Retrofitæ–‡æ¡£](https://square.github.io/retrofit/)
- [Roomæ–‡æ¡£](https://developer.android.com/training/data-storage/room)

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **API_BASEé…ç½®**: å½“å‰é…ç½®ä¸ºGoogle URLï¼Œé¢è¯•æ—¶éœ€è¦æ ¹æ®å®é™…éœ€æ±‚ä¿®æ”¹
2. **æ•°æ®åº“ç‰ˆæœ¬**: ä¿®æ”¹æ•°æ®åº“ç»“æ„æ—¶éœ€è¦å¢åŠ ç‰ˆæœ¬å·
3. **çº¿ç¨‹å®‰å…¨**: Roomæ•°æ®åº“æ“ä½œåº”åœ¨åå°çº¿ç¨‹æ‰§è¡Œ
4. **å†…å­˜æ³„æ¼**: æ³¨æ„LiveDataå’ŒRxJavaçš„è®¢é˜…ç”Ÿå‘½å‘¨æœŸ
5. **ç½‘ç»œæƒé™**: å·²åœ¨AndroidManifest.xmlä¸­å£°æ˜INTERNETæƒé™

## ğŸ¯ é¢è¯•å‡†å¤‡å»ºè®®

1. **ç†Ÿæ‚‰é¡¹ç›®ç»“æ„**: äº†è§£æ¯ä¸ªæ¨¡å—çš„ä½œç”¨
2. **ç†è§£ä¾èµ–æ³¨å…¥**: æŒæ¡Koinçš„åŸºæœ¬ç”¨æ³•
3. **æŒæ¡åç¨‹**: ç†è§£ä¸åŒè°ƒåº¦å™¨çš„ä½¿ç”¨åœºæ™¯
4. **ç†Ÿæ‚‰æ‰©å±•å‡½æ•°**: äº†è§£Kotlinæ‰©å±•å‡½æ•°çš„ç”¨æ³•
5. **å®è·µç½‘ç»œè¯·æ±‚**: ç»ƒä¹ ä½¿ç”¨Retrofit + RxJava
6. **æ•°æ®åº“æ“ä½œ**: ç†Ÿæ‚‰Roomçš„åŸºæœ¬ç”¨æ³•

## ğŸ“„ è®¸å¯è¯

æ­¤é¡¹ç›®ä¸ºé¢è¯•å‡†å¤‡é¡¹ç›®ï¼Œç”±å…¬å¸æä¾›ã€‚

---

**æœ€åæ›´æ–°**: 2024å¹´
**é¡¹ç›®ç‰ˆæœ¬**: 1.0

